<!DOCTYPE html>
<html lang="en-US">
<head>
    <script>
        const theme = localStorage.getItem('theme');
        if (theme === "dark") {
            document.documentElement.setAttribute('data-theme', 'dark');
        }
    </script>
    <meta charset="UTF-8">
    <link id='CSS' rel='stylesheet' type='text/css' href='/css/main.css'><link id='CSS' rel='stylesheet' type='text/css' href='/css/code.css'><title>How to Create a Random Post Link in Jekyll</title>
    <meta name="description" content="How to link to a random post using Jekyll or any other static blog using a bit of client-side JavaScript">
    <meta name="author" content="Derek Kedziora"><meta property="article:published_time" content="2018-01-27"><link rel="canonical" href="http://localhost:4000/blog/Getting-Random-Post-in-Jekyll">
    <link rel="shortcut icon" href="/static/derek.png">
    <link rel="apple-touch-icon" href="/static/derek.png"> 
    <meta name=viewport content="width=device-width, initial-scale=1">
    <meta property="og:locale" content="en_US">
    <meta property="og:title" content="How to Create a Random Post Link in Jekyll"/>
    <meta property="og:type" content="article"/>
    <meta property="og:url" content="http://localhost:4000/blog/Getting-Random-Post-in-Jekyll"/>
    <meta property="og:image" content="https://derekkedziora.com/static/derek.png"/>
    <meta property="og:site_name" content="Derek Kedziora's Blog">
    <meta property="og:description" content="How to link to a random post using Jekyll or any other static blog using a bit of client-side JavaScript">
    <meta name="twitter:card" content="summary"/>
    <meta name="twitter:title" content="How to Create a Random Post Link in Jekyll"/>
    <meta name="twitter:description" content="How to link to a random post using Jekyll or any other static blog using a bit of client-side JavaScript"/>
    <meta name="twitter:image" content="https://derekkedziora.com/static/derek.png"/></head>
<body>
  <div class="mode-switcher">
    <a href="#" id="theme-toggle" onclick="modeSwitcher()"></a>
  </div>
  <article>
    <header>
      <h1>How to Create a Random Post Link in Jekyll</h1>
        <div class="sub-title-menu"><a href="/" rel="author" title="Derek Kedziora">Derek Kediora</a>
          <time>27 January 2018</time>
        </div>
    </header>
      <p>There’s something fun about random post buttons, and adding one to my blog became a coding challenge. If you’d like to just copy and paste the code for your own Jekyll blog, skip the backstory and <a href="#code">go to the code</a>.</p>

<h2 id="the-solution">The Solution</h2>

<p>Here’s what I wanted:</p>

<ul>
  <li>A link to a random blog post</li>
  <li>To exclude the current page from possible destinations</li>
</ul>

<p>The concept is straightforward: add the URL of each post to an array, exclude the post that the user clicked the random link on, generate a random number between zero and the number of posts and then <code class="highlighter-rouge">[array][randomNumber]</code> gives you the link to a random post.</p>

<p>Creating the array with a mix of <a href="https://shopify.github.io/liquid/">Liquid</a> and JavaScript was easy enough.</p>

<p>The technical limitations of a Jekyll blog mean that client-side JavaScript is the only way generate a random number. Still easy enough.</p>

<p>This could easily get cumbersome if I did this on each page. Why slow down load times when most readers are never going to notice my random post link anyway? The most logical work around was to create a new page to build the array and generate the random number on and then automatically redirect the reader to the random post. I later figured out this is how <a href="https://en.wikipedia.org/wiki/Special:RandomInCategory/Featured_articles">Wikipedia</a> and <a href="http://reddit.com/r/random">Reddit</a> operate their random links, albeit server side.</p>

<p>The real trick was excluding the current page from the array. I decided to create the array statically each time the site is built. Removing the current page from the array proved buggy. So I added a <code class="highlighter-rouge">do while</code> loop to generate another random number if the first one matched the current post. In theory, this could lead to an infinite loop; in practice, you’re looking at something like a one in a million shot at looping through more than five times. Just in case, I put a break after 10 iterations.</p>

<h2 id="code">The Code</h2>

<p>Copy this code into the <code class="highlighter-rouge">&lt;head&gt;</code> section of your random redirect page and reset the manual links in case someone hits the one in a million chance of needing them:</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="o">&lt;</span><span class="nx">script</span><span class="o">&gt;</span>
<span class="kd">var</span> <span class="nx">comingFromPost</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">referrer</span><span class="p">;</span>

<span class="kd">function</span> <span class="nx">linkToRandomBlogPost</span><span class="p">()</span> <span class="p">{</span>
	<span class="kd">var</span> <span class="nx">allPosts</span> <span class="o">=</span> <span class="p">[{</span><span class="o">%</span> <span class="k">for</span> <span class="nx">post</span> <span class="k">in</span> <span class="nx">site</span><span class="p">.</span><span class="nx">posts</span> <span class="o">%</span><span class="p">}</span>
      <span class="dl">"</span><span class="s2">{{ post.url }}</span><span class="dl">"</span><span class="p">{</span><span class="o">%</span> <span class="nx">unless</span> <span class="nx">post</span><span class="p">.</span><span class="nx">previous</span> <span class="o">==</span> <span class="nx">nil</span> <span class="o">%</span><span class="p">},{</span><span class="o">%</span> <span class="nx">endunless</span> <span class="o">%</span><span class="p">}</span>
	<span class="p">}</span>
    <span class="p">{</span><span class="o">%</span> <span class="nx">endfor</span> <span class="o">%</span><span class="p">}];</span>

<span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="k">do</span> <span class="p">{</span>
	<span class="kd">var</span> <span class="nx">randomPostLink</span> <span class="o">=</span> <span class="nx">allPosts</span><span class="p">[</span><span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span> <span class="o">*</span> <span class="nx">allPosts</span><span class="p">.</span><span class="nx">length</span><span class="p">)];</span> <span class="nx">i</span><span class="o">++</span><span class="p">;}</span>
<span class="k">while</span> <span class="p">(</span><span class="nx">comingFromPost</span><span class="p">.</span><span class="nx">includes</span><span class="p">(</span><span class="nx">randomPostLink</span><span class="p">)</span> <span class="o">||</span> <span class="nx">i</span> <span class="o">&gt;</span> <span class="mi">10</span><span class="p">)</span>

<span class="k">if</span> <span class="p">(</span><span class="nx">i</span> <span class="o">&gt;</span> <span class="mi">10</span> <span class="o">&amp;&amp;</span> <span class="nx">comingFromPost</span> <span class="o">!==</span> <span class="dl">'</span><span class="s1">/blog/Getting-Random-Post-in-Jekyll</span><span class="dl">'</span><span class="p">)</span> <span class="p">{</span>
	<span class="nx">randomPostLink</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">/blog/Getting-Random-Post-in-Jekyll</span><span class="dl">'</span><span class="p">;}</span>

<span class="k">if</span> <span class="p">(</span><span class="nx">i</span> <span class="o">&gt;</span> <span class="mi">10</span> <span class="o">&amp;&amp;</span> <span class="nx">comingFromPost</span> <span class="o">===</span> <span class="dl">'</span><span class="s1">/blog/Getting-Random-Post-in-Jekyll</span><span class="dl">'</span><span class="p">)</span> <span class="p">{</span>
	<span class="nx">randomPostLink</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">/blog/Creating-a-Tag-Page-with-Jekyll</span><span class="dl">'</span>
	<span class="p">}</span>

<span class="k">return</span> <span class="nx">randomPostLink</span><span class="p">;</span>
<span class="p">}</span>

<span class="nx">location</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="nx">linkToRandomBlogPost</span><span class="p">())</span>

<span class="o">&lt;</span><span class="sr">/script&gt;</span></code></pre></figure>

<h2 id="the-payoff">The Payoff</h2>

<p>If you go to <a href="/blog/random">derekkedziora.com/blog/random</a>, you’ll automatically be redirected to a random post on my blog.</p>

<p>For a more philosophical read about randomness, there’s always <a href="https://en.wikipedia.org/wiki/The_Dice_Man">The Dice Man</a>. Have some fun and get outside your bubble with randomness.</p>


  </article><footer>
Derek Kedziora<br> 
<a href="/blog">Blog</a>, <a href="/about" title="About">About</a>, <a href="/portfolio" title="Portfolio">Portfolio</a><br>
New Blog Posts: <a href="/feed.xml" title="RSS">RSS</a>, <a href="https://t.me/@derekblog" title="Telegram">Telegram</a><br>
derekkedziora@icloud.com<br>
</footer> <script src="/assets/scripts/mode-switcher.js"></script>
</body>
</html>

